---
import NavLink from './NavLink.astro';

interface Props {
    showLogout?: boolean;
}
const { showLogout = false } = Astro.props;
---
<aside class="w-64 bg-background-light ...">
    <div class="flex flex-col gap-2">
        <NavLink href="#" icon="settings" label="Configuración" />
        
        {showLogout ? (
            <button id="logout-btn" class="flex items-center gap-3 px-4 py-2 rounded text-red-500 hover:bg-red-500/10 w-full">
                <span class="material-symbols-outlined">logout</span>
                <span class="text-sm font-medium">Cerrar Sesión</span>
            </button>
        ) : (
            <a class="flex items-center gap-3 px-4 py-2 ..." href="#">
                <div class="w-8 h-8 rounded-full ..."></div>
                <span class="text-sm font-medium">Sergio</span>
            </a>
        )}
    </div>
</aside>

<script>

    import { supabase } from '../../lib/supabase';

    const logoutButton = document.getElementById('logout-btn');

    if (logoutButton) {
        logoutButton.addEventListener('click', async () => {
            const { error } = await supabase.auth.signOut();
            if (error) {
                console.error('Error al cerrar sesión:', error.message);
            } else {
                window.location.href = '/login';
            }
        });
    }
</script>